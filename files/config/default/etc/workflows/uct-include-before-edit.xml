<?xml version="1.0" encoding="UTF-8"?>
<definition xmlns="http://workflow.opencastproject.org">

  <id>uct-include-before-edit</id>
  <title>UCT - Process for Editing</title>
  <tags/>
  <description>
    REQUIRES:
      Flavors:
        */source
      Workflow Properties:
        empty_venue
        timetabled
        audio_trim_autotrim
        audio_trim_valid_venue
  </description>

  <configuration_panel></configuration_panel>

  <operations>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      Prepare work versions of the source material for further processing.
      Preview and Publish use Work versions. (*/work)
    -->
    <operation
      id="include"
      if="NOT(${empty_venue})"
      description="Prepare work version for processing">
      <configurations>
        <configuration key="workflow-id">uct-partial-work</configuration>
      </configurations>
    </operation>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      Run the script to detect the audio points and create a smil/cutting if possible
    -->
    <operation
      id="include"
      if="NOT(${empty_venue})"
      description="Run the audio analysis for (possible) autotrimming of the recording">
      <configurations>
        <configuration key="workflow-id">uct-include-autotrim-detection</configuration>
      </configurations>
    </operation>

    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      Decide Auto trimming and publish or Review
      If a recording has a good_start, good_end, isHour and non speech used
      segments is 0 then it is marked to be auto trimmed and published
      It also depends on if the recording is timetabled and it is a valid venue
      Else it goes into the normal queue to be reviewed
    -->
    <operation
      id="include"
      if="${timetabled} AND ${audio_trim_autotrim} AND ${audio_trim_valid_venue} AND NOT(${empty_venue})"
      description="RECORDING: Auto trim and publish (no preview)">
      <configurations>
        <configuration key="workflow-id">uct-include-before-edit-auto-trim</configuration>
      </configurations>
    </operation>

    <operation
      id="include"
      if="NOT(${timetabled} AND ${audio_trim_autotrim} AND ${audio_trim_valid_venue} AND ${empty_venue})"
      description="RECORDING: Review">
      <configurations>
        <configuration key="workflow-id">uct-include-before-edit-review</configuration>
      </configurations>
    </operation>

  </operations>
</definition>